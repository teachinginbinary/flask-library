{% extends 'base.html'%}
{% block content %}
    <div class="container mt-5" style="margin-top: 100px;">
        <h2>Crear Libro</h2>
        
        <form action="{{ url_for('books.create_books') }}" method="POST" class="form-horizontal">
            <div class="form-group">
                <label for="name" class="col-sm-2 control-label">Nombre del libro:</label>
                <div class="col-sm-10">
                    <input type="text" name="name" id="name" class="form-control">
                </div>
            </div>
            <div class="form-group">
                <label for="description" class="col-sm-2 control-label">Descripción del libro:</label>
                <div class="col-sm-10">
                    <textarea name="description" id="description" class="form-control"></textarea>
                </div>
            </div>
            <div class="form-group">
                <label for="text" class="col-sm-2 control-label">Texto del libro:</label>
                <div class="col-sm-10">
                    <textarea name="text" id="text" class="form-control"></textarea>
                </div>
            </div>
            <div class="form-group">
                <label for="cover_photo" class="col-sm-2 control-label">URL de la foto de portada:</label>
                <div class="col-sm-10">
                    <input type="text" name="cover_photo" id="cover_photo" class="form-control">
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <button type="submit" class="btn btn-default">Crear libro</button>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <p id="errorMensage" class="text-3xl text-danger font-custom">{{ error }}</p>                    
                </div>
            </div>
        </form>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const form = document.querySelector('form');
            const errorMensageElement = document.getElementById('errorMensage'); // Obtén el elemento directamente
        
            form.addEventListener('submit', (e) => {
                e.preventDefault(); // Evita que el formulario se envíe por defecto
        
                let name = document.getElementById('name').value;
                let description = document.getElementById('description').value;
                let text = document.getElementById('text').value;
                let cover_photo = document.getElementById('cover_photo').value;
        
                if (name.length < 10 || description.length < 10 || text.length < 10 || cover_photo.length < 10) {
                    if (errorMensageElement) { // Verifica si el elemento existe antes de intentar cambiar su textContent
                        errorMensageElement.textContent = 'Por favor ingresa los caracteres mínimos'; // Establece el mensaje de error
                        console.log(name.length, description.length, text.length, cover_photo.length)
                        console.log(name, description, text, cover_photo)
                    }
                } else {
                    // Envía el formulario si todos los campos cumplen con los requisitos
                    form.submit(); // Utiliza el método submit() para enviar el formulario
                }
            });
        });
        
    </script>
{% endblock content %}
